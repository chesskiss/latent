# import jax.numpy as jnp
# from jax import vmap

# vv = lambda x, y: jnp.vdot(x, y)  #  ([a], [a]) -> []
# mv = vmap(vv, (0, None), 0)      #  ([b,a], [a]) -> [b]      (b is the mapped axis)
# mm = vmap(mv, (None, 1), 1)      #  ([b,a], [a,c]) -> [b,c]  (c is the mapped axis)

# a = jnp.array([1,1,1])
# b = jnp.array([2,1,0])
# A = a[None]
# print(A)
# print(mv(A,b))


import pandas as pd
import numpy as np

def dframe(data, index=['T0', 'T1', 'T2']):
    result = {}
    for key, value in data.items():
        arr = np.array(value)
        if arr.ndim == 1:
            arr = arr.reshape(1, -1)
        result[key] = arr.T.tolist()
    
    df = pd.DataFrame(result, index=index)
    return df

# Test data
data = {
    'S0': [[0.9310199618339539, -487.2692565917969, -1222.5260009765625], 
           [0.9301355481147766, -470.9032897949219, -1179.9246826171875]],
    'S1': [[-10.34585189819336, 0.03304697945713997, -8.23599910736084], 
           [-10.432733535766602, 0.14426057040691376, -8.45174789428711]],
    'S00': [[0.9338423013687134, -484.57708740234375, -1217.4638671875], 
            [0.9307991862297058, -467.2206115722656, -1171.578857421875]],
    'S01': [[-10.307413101196289, 0.7140099406242371, -7.795291900634766], 
            [-10.386242866516113, 0.706073522567749, -7.8934407234191895]],
    'S11': [[-10.335633277893066, 0.19122131168842316, -8.180229187011719], 
            [-10.410856246948242, 0.1675550490617752, -8.368451118469238]],
    'S_l0': [[0.645107626914978, -462.34185791015625, -1166.82470703125]]
}

df = dframe(data)
print(df)